
# part A
nsim <- 1000

capture<- c(127.7,133.2,135.3,143.3,139.3,140.2,143.8,144.6,147.6,144.8,146.8,145.9,151,148.7,147.8,148.3,149.2,149,149.2,148.7,149,151.1,150.4,149.4,150,151,150,150.7,147.6,151.9,151.5,151.1,151,151.8,150.9,150,154,152.6,152.6,152.6,151.1,151.4,155,151.8,154.2,154,151.9,155.5,155.9,153.1,155.4,154.2,153,151.7,153.4,154,155.6,156.2,155.6,154.3,158.2,155.6,156.5,157.3,155.8,156.6,155.9,156.6,155,158.2,158.7,155.9,159.1,155.6,158.6,154.3,161.6,157,154.6,157.9,160,159.9,157.1,159.9,157,159.6,160.6,155.6,159.6,162.7,158.3,160.1,163.7,163.2,164.7,163.5,166.5,130.8,141.6,142.5,147.5,151.4,154.2,152.3,159.5,156.6,154.6,157.8,161.7,160.6,156)

shapiro.test(capture)

caplen <- length(capture)

wild<- c(154.8,142.5,154.9,136.5,146.6,151.5,154.4,152.2,155.3,133.3,149.7,157.5,155.3,152.9,154.3,143.1,145.2,135.4,153.5,148.9,139.1,155.4,154.7,149.5,151.5,160.1,153.2,142,153.8,164.9,155.7,155.8,158.9,155.2,164.1,161.3,156.7,148.2,156.5,147.8,157.7,149.1,151.5,146.7,148.5,156.6,155,129.5,101.4,128.9,101.9,105.1,114.8,91.5,96.4,94.5,131.1,93.8,101.3,95.5,82.3,97.2,92.1,96.3,104.6,38.8,51.8,110.2,120,121.9,134.8,148,158.2,154.8,141.8,141.6,146.6,133.8,136.5,140.9,140.4,148.5,145.8,142.8,142.4,149.1,149.5,127.6,136.2,145.8,154.2,147.1,159.4,162.6,151.5,118,145.5,148.2,135.9,136.1,128.6,139.8,136.7,135.1,149,163.7,149.8,143.2,143.2,157,152.7,153.6,140.6,151.7,132,132.5,154.5,143.3,138.1,126.7,132.4,149.3,139.3,151.5,166.8,126.8,152.1,126.9,145.4,156.3,142.7,132.9,137.9,126.1,160.4,166.2,145.4,144.3,156.8,131.2,140.8,130.8,149.7,156.7,136.1,150.1,140.7,139.4,160.1,138.2,148.6,152,128.2,126.7,142.5,139.7,151.8,141.1,140.7,157.5,143.8,127.7,155.2,146.9,125,133.5,144.4,154.6,154.4,138.6,133.7,153.2,159.1,149.5,144.7,147.3,138.4,136.9,146.6,124.5,144.1,124.4,142.2,134.1,133.8,127.8,132.3,135.6,130.3,128.7,118.8,133.4,151.6,140.6,144.6,147.7,154.8,139.1,124.2,129.5,123.7,130.6,134.7,153.9,148.4,130.1,135.8,140.3,138.7,140.6,127.6,127.7,127.5,138.3,127.3,151.5,140.5,128.5,145.9,135.5,125.4,146.3,144.5,148.8,127.8,137.7,149.6,128,141.8,138.5,136.1,130.1,139.2,153.4,141.6,138.6,153,139.8,140.8,138,146.7,135.9,144.4,138.5,125.3,131.9,134.3,147.8,147.7,144.2,132,136.1,148.1,147.5,122.4,147.7,144.2,132,136.1,148.1,147.5,122.4,135.8,135.2,126.5,140.3,145.8,152.1,147,150.4,155.7,140.5,139.3,131.5,142.7,158.2,135.8,147.2,150,148.2,139.8,143.7,141.3,147.2,139.7,130.3,149.3,150.4,160,161.6,149.3,129.2,142.7,143.6,132,133.2,137.8,145.4,150.8,147.2,143.7,144.7,148.1,135.4,145.8,154.2,144.3,133.7,155.4,142.4,149.5,157.1,147.6,143.5,138.9,157,140.8,156.4,153.1,152.3,130.5,149.8,142.3,153.4,147.9,149.9,152.2,150.4,141.8,152.4,133.7,147.1,151.7,153.6,145.2,141.6,138.3,135.2,153.5,153.3,151.6,152.9,147.5,141.9,145.9,140.3,148.5,151.4,138.6,146.4,134.3,154.1,146.4,149.4,134.7,161.7,150.3,151.2,143.5,148.3,129.2)

shapiro.test(wild)

wildlen <- length(wild)

capm <- mean(capture)
wildm <- mean(wild)

wildbm <- rep(0,nsim)
capbm <- rep(0,nsim)

# boot strap

for (i in 1 : nsim) {
wildb <- sample (wild,replace=T)
wildbm[i] <- mean(wildb)
capb <- sample (capture,replace=T)
capbm[i] <- mean(capb)
}

wildstd <- sd(wildbm)
capstd <- sd(capbm)

# hypothesis testing , pvalue calculation

theta <- (capm-wildm)/sqrt(((wildstd^2))+((capstd^2)))

pval <- pnorm(theta)


### part b ####
wild<- c(14.1,15.1,15.4,17.1,12.6,12.9,15.6,15.1,17.1,13.2,15.1,13.7,18.6,15.9,15,14.7,15.4,14.9,14.9,14.1,13.8,15.9,14.9,13.8,13.9,14.8,13.7,14.3,10.9,15.1,14.6,13.8,13.6,14.2,13.3,12.4,16,14.4,14.3,14.3,12.8,12.9,16.1,12.6,14.7,14.5,11.9,15.4,15.7,12.8,15.1,13.6,12.3,10.7,12.1,12.7,14.3,14.9,14.1,12.3,16.2,13.3,14.2,14.9,13.1,13.7,12.9,13.5,11.5,14.6,15,12.2,15.4,11.7,14.6,9.8,17,12.4,9.9,12.9,14.8,14.5,11.7,14.2,11.3,13.9,14.7,9.6,12.4,15.3,10.7,12.1,15.6,15.1,13.7,12.3,12.6,15.2,18.6,18.1,11.4,14.5,15.6,12.6,19.7,15.3,10.9,13.6,15.3,12.8,8.1)

capture<-c(12.5,17.4,14.1,14.1,13.4,12.6,11.3,12.5,14.9,16.7,12.3,14.5,12.1,12.1,13.6,12.3,13.4,14.8,13.4,15.9,16.2,12.4,15.2,12,14.8,14.2,10.1,13.5,12.7,14,11.1,12.5,12.4,11.7,13.9,13,13.6,12.5,13.1,14.8,14.5,12.1,10.7,13.9,13.8,14.2,13.8,17.6,17.1,19.1,18.1,19,22.8,20.1,18.5,19.3,18,22.4,19.9,20.7,19.6,21.4,17.9,23.9,21,7.7,11.3,21.9,21.8,19.8,18.7,12.4,15,11.9,18.4,16.1,17.1,13.7,14,17.6,12.6,13.8,17.2,18.6,16.9,17.7,13.4,17,13.9,11.7,15.9,13.8,9.6,13.4,9,13.4,18.4,18.4,14.8,16.9,17.7,17.3,17.4,16.9,11.5,14.8,18.5,16.3,13.9,12.7,15.5,14.6,17.3,13.3,20.3,15.3,12.5,13.3,15.8,12,13.1,17.6,19,15.3,12.3,17.3,12.9,18.6,16.9,11.8,19.4,15.2,18.2,12.5,12.2,11.1,14.4,12.1,11.9,18.7,16.7,16.9,14.2,14.3,14.8,13.4,18.7,13.8,10.2,14.9,15,13.2,17.5,15.2,17.7,13.5,13.2,15.9,14.5,12.4,17.8,17.2,14.7,18.3,21.1,14.6,13.4,13.2,15.2,18.8,18.7,13.4,14.6,14.8,18.6,16.9,17.6,17.7,14.3,18.2,18.4,16.8,13.7,14.6,17.6,15.5,16.7,16.6,16.7,17.1,6.1,15.9,15.3,15.4,15.7,15.7,14.4,17.5,15.6,17.7,16.5,14.7,13.3,16.5,14.7,14.4,13.6,14.1,13.2,12.3,14.7,16.9,16.5,13,16.4,13.8,13.9,16.5,15.4,15.9,16.6,13.4,18.5,18,15.9,17,13.9,15.4,18.7,17.5,16.2,16.5,16.5,13.4,16.1,16.5,12.3,12.8,13.2,15.4,11.7,16.5,14,13.5,16.4,17.1,12.7,13,13.8,16.1,16.7,15.2,17.9,14.8,14.4,13.8,16.1,16.7,15.2,17.9,14.8,14.4,17.1,15.2,17.4,16.2,12.6,12.5,13.1,13.2,12.6,11.7,17.6,15.2,12.6,11.8,16.9,14.3,14.8,13.2,14.4,17,16.3,14,15.4,15,12.5,12.8,12.5,14.1,13.3,15.9,16.4,14,15.7,16.6,16.9,14.4,14.3,13.9,11.7,13.3,12.3,16.8,16,13,12.3,15,13.9,11.7,11.8,14.1,12.9,12.3,13,12.2,12.3,13,11.4,13.1,14.7,12.6,11.3,11.5,14.5,15.6,14.3,11.8,11,14.3,11.8,10.2,13.1,12.2,13,17.1,12.6,15.9,12.8,13.7,12,14.9,12.7,17.5,13.3,15.2,13.2,12.3,8.9,11.5,15.6,15.8,15.2,14.2,15.3,13.6,14.4,15.6,13.9,14.2,14.8)

shapiro.test(capture)
shapiro.test(wild)
caplen <- length(capture)
wildlen <- length(wild)

capm <- mean(capture)
wildm <- mean(wild)

wildbm <- rep(0,nsim)
capbm <- rep(0,nsim)

# boot strap

for (i in 1 : nsim) {
wildb <- sample (wild,replace=T)
wildbm[i] <- mean(wildb)
capb <- sample (capture,replace=T)
capbm[i] <- mean(capb)
}

wildstd <- sd(wildbm)
capstd <- sd(capbm)

# hypothesis testing , pvalue calculation

theta <- (capm-wildm)/sqrt(((wildstd^2))+((capstd^2)))

pval <- pnorm(theta)


## part C ######

prop<-c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)

plen <- length(prop)

mp <- sum(prop)
wildbm <- rep(0,nsim)

for (i in 1 : nsim) {
wildb <- sample (prop,replace=T)
wildbm[i] <- sum(wildb)/plen
}

cat ("95% confid interval",quantile(wildbm,0.025),quantile(wildbm,0.975))

# part d ########
crab<-read.csv("C:\\satish\\IIMA\\Acads\\Term4\\AMDA\\Crab\\crab.csv")
attach(crab)
names(crab)
crab.lm <-lm(inc~postsz)
#crab.lm <-lm(presz~postsz+y1+y2+y3+lf)
summary(crab.lm)
par(mfrow=c(2,2))
plot(crab.lm,residuals=F,pch=16)
#plot(presz,fitted(crab.lm))
#plot(fitted(crab.lm),residuals(crab.lm))
#plot(postsz,residuals(crab.lm))



